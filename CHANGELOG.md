# 📋 更新日志 (CHANGELOG)

所有重要的项目更改都将记录在此文件中。

## [v1.0.0-dev] - 2025-08-06

### ✨ 新增功能
- **签到系统**: 完整的活动签到管理功能
  - 6位随机签到码生成算法
  - 签到码持久化存储（支持页面刷新和重新登录）
  - 活动创建者签到管理界面
  - 用户现场签到功能
  - 签到记录实时展示
- **权限验证**: 严格的签到权限控制
  - 只有报名通过且已支付的用户可以签到
  - 防重复签到机制（数据库唯一约束）
  - 创建者专属签到码管理权限
- **界面集成**: 签到功能完整集成
  - 活动详情页面签到组件
  - 活动管理页面签到管理入口
  - 实时状态同步和用户反馈

### 🔧 改进优化
- **数据库设计**: 扩展Activity实体，新增CheckIn实体
  - Activity表添加checkInCode和checkInEnabled字段
  - CheckIn表记录完整签到信息
  - 建立用户-活动签到唯一约束
- **API架构**: 完整的签到API接口体系
  - 5个核心签到API端点
  - RESTful设计风格
  - JWT身份验证和权限控制
- **前端组件**: 模块化签到组件设计
  - CheckInComponent（用户签到界面）
  - CheckInManagement（管理者界面）
  - 状态驱动的UI更新

### � 安全特性
- **签到码安全**: 6位大写字母数字组合，避免猜测
- **权限分离**: 创建者和参与者权限严格分离
- **状态验证**: 多重用户资格验证机制
- **防刷机制**: 数据库层面防止重复签到

### 📚 文档更新
- **功能文档**: 新增CHECKIN_SYSTEM.md专项文档
- **设计文档**: 更新数据库实体和API接口设计
- **README**: 更新核心特色和功能模块描述

### 📱 移动端优化
- **响应式导航**: 新增移动端汉堡菜单，支持小屏幕导航
- **表单适配**: 优化创建活动、登录注册页面的移动端布局
- **触摸友好**: 增大按钮触摸面积（最小48px），改善移动端操作体验
- **布局优化**: 调整网格系统断点，使用lg替代md提供更好的响应式体验
- **字体与间距**: 优化移动端字体大小和内边距，提升可读性

---

## [v1.0.0-beta] - 2025-08-05

### ✨ 新增功能
- **点赞系统**: 实现每用户每评论只能点赞一次的智能点赞功能
- **权限控制**: 评论权限预检查，根据用户参与状态动态显示按钮
- **内联表单**: 评论表单改为内联展开模式，提升用户体验
- **视觉反馈**: 点赞状态用不同颜色和填充样式区分

### 🔧 改进优化
- **界面设计**: 评论表单背景从弹窗改为渐变背景的内联卡片
- **数据安全**: 解决外键约束问题，删除评论时自动清理点赞记录
- **API优化**: 合并点赞/取消点赞API，提供统一的切换接口

### 🐛 问题修复
- **删除约束**: 修复评论删除时的外键约束错误
- **权限检查**: 修复评论权限检查的用户认证问题
- **状态同步**: 修复点赞状态的前端显示同步问题

### 📚 文档更新
- **设计文档**: 更新CommentLike实体描述和API接口文档
- **README**: 更新功能特色和社交功能描述
- **实体关系**: 更新数据库实体关系图

---

## [v1.0.0-alpha] - 2025-08-05

### ✨ 新增功能
- **评论系统**: 完整的评论CRUD功能，支持星级评分
- **权限验证**: 只有参与过活动的用户才能评论
- **评分统计**: 自动计算活动平均评分

### 🔧 改进优化
- **用户体验**: 优化评论表单界面设计
- **权限反馈**: 为无权限用户提供清晰的提示信息

---

## [v0.9.0] - 2025-08-01

### ✨ 新增功能
- **订单系统**: 完整的订单管理和模拟支付功能
- **支付流程**: 报名审核通过后自动创建订单
- **退款功能**: 支持订单取消和退款操作

### 🔧 改进优化
- **认证机制**: 修复用户认证问题，使用Headers认证
- **数据统计**: 修复活动参与人数统计

---

## [v0.8.0] - 2025-07-31

### ✨ 新增功能
- **报名系统**: 在线报名、审核流程、状态管理
- **活动管理**: 完整的活动CRUD操作
- **用户系统**: 注册登录、个人资料管理

### 🏗️ 架构搭建
- **前端**: React 18 + Vite + Tailwind CSS
- **后端**: Node.js + TypeScript + Midway.js + TypeORM
- **数据库**: SQLite 本地开发数据库

---

## 📝 版本说明

- **v1.x.x**: 正式版本，功能完整稳定
- **v0.x.x**: 开发版本，功能逐步完善
- **dev**: 开发分支，包含最新功能

## 🔄 升级指南

### v0.9.0 → v1.0.0
1. 数据库迁移：添加CommentLike表
2. 依赖更新：无新增依赖
3. 配置变更：无配置变更

### 注意事项
- 评论删除功能需要新的数据库约束处理
- 点赞功能需要用户登录状态验证
- 建议在测试环境先验证所有功能

---

*更新日志按照 [Keep a Changelog](https://keepachangelog.com/) 格式维护*
